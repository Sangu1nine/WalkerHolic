# ë³´í–‰ ë¶„ì„ ì•± ë°ì´í„°ë² ì´ìŠ¤ ì™„ì „ ì¬êµ¬ì„± ê°€ì´ë“œ
# CREATED: 2024-12-19 - ì „ì²´ ë°ì´í„°ë² ì´ìŠ¤ ì²˜ìŒë¶€í„° ì¬êµ¬ì„± ê°€ì´ë“œ

## ğŸš¨ ì£¼ì˜ì‚¬í•­
- ì´ ê³¼ì •ì€ **ëª¨ë“  ê¸°ì¡´ ë°ì´í„°ë¥¼ ì‚­ì œ**í•©ë‹ˆë‹¤!
- ì‹¤í–‰ ì „ ë°˜ë“œì‹œ **ë°±ì—…**ì„ ìˆ˜í–‰í•˜ì„¸ìš”!
- ì‹œê°„ëŒ€ ë¬¸ì œê°€ ì™„ì „íˆ í•´ê²°ë©ë‹ˆë‹¤!

## ğŸ“‹ ì‹¤í–‰ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 1. ë°ì´í„° ë°±ì—… (í•„ìˆ˜!)
```bash
# PostgreSQL ë°±ì—…
pg_dump -h [í˜¸ìŠ¤íŠ¸] -U [ì‚¬ìš©ìëª…] -d [ë°ì´í„°ë² ì´ìŠ¤ëª…] > backup_$(date +%Y%m%d_%H%M%S).sql

# ë˜ëŠ” Supabase ëŒ€ì‹œë³´ë“œì—ì„œ ë°±ì—… ìƒì„±
```

### 2. ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ë‹¨
```bash
# ë°±ì—”ë“œ ì„œë²„ ì¤‘ë‹¨
pkill -f "python"
# ë˜ëŠ” ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
- PostgreSQL/Supabase ì ‘ì† ê°€ëŠ¥í•œì§€ í™•ì¸
- ê´€ë¦¬ì ê¶Œí•œ ìˆëŠ”ì§€ í™•ì¸

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### ë°©ë²• 1: SQL ì—ë””í„°ì—ì„œ ì§ì ‘ ì‹¤í–‰
1. PostgreSQL í´ë¼ì´ì–¸íŠ¸ ë˜ëŠ” Supabase SQL Editor ì ‘ì†
2. `complete_database_setup.sql` íŒŒì¼ ë‚´ìš© ë³µì‚¬
3. **ì˜êµ¬ ì‹œê°„ëŒ€ ì„¤ì • ë¶€ë¶„ ìˆ˜ì •**:
   ```sql
   -- ì´ ë¼ì¸ì˜ ì£¼ì„ì„ í•´ì œí•˜ê³  ì‹¤ì œ DB ì´ë¦„ìœ¼ë¡œ ë³€ê²½
   ALTER DATABASE your_actual_database_name SET timezone = 'Asia/Seoul';
   ```
4. ì „ì²´ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

### ë°©ë²• 2: ëª…ë ¹ì¤„ì—ì„œ ì‹¤í–‰
```bash
# PostgreSQL ì§ì ‘ ì—°ê²°
psql -h [í˜¸ìŠ¤íŠ¸] -U [ì‚¬ìš©ìëª…] -d [ë°ì´í„°ë² ì´ìŠ¤ëª…] -f complete_database_setup.sql

# ë˜ëŠ” íŒŒì´í”„ë¡œ ì‹¤í–‰
cat complete_database_setup.sql | psql -h [í˜¸ìŠ¤íŠ¸] -U [ì‚¬ìš©ìëª…] -d [ë°ì´í„°ë² ì´ìŠ¤ëª…]
```

## ğŸ“Š ì‹¤í–‰ ê²°ê³¼ í™•ì¸

### ì„±ê³µì ì¸ ì‹¤í–‰ ì‹œ ë§ˆì§€ë§‰ì— ë‹¤ìŒê³¼ ê°™ì€ ê²°ê³¼ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤:

```
| step                  | total_tables |
| --------------------- | ------------ |
| Table Creation Check  | 11           |

| step               | table_name              | column_name        | data_type                |
| ------------------ | ----------------------- | ------------------ | ------------------------ |
| Timezone Data Types| analysis_results        | analysis_timestamp | timestamp with time zone |
| Timezone Data Types| analysis_results        | created_at         | timestamp with time zone |
| ...                | ...                     | ...                | ...                      |

| step              | table_name     | record_count |
| ----------------- | -------------- | ------------ |
| Sample Data Check | users          | 2            |
| Sample Data Check | gait_rag_data  | 5            |
| Sample Data Check | analysis_results| 2           |

| step                 | timezone_setting | offset_hours | timezone_status                    |
| -------------------- | ---------------- | ------------ | ---------------------------------- |
| Final Timezone Check| Asia/Seoul       | 9            | Asia/Seoul (+09:00) - Perfect! âœ…  |

| message                        | details                                                    |
| ------------------------------ | ---------------------------------------------------------- |
| ğŸ‰ DATABASE SETUP COMPLETE! ğŸ‰ | All tables, indexes, views, and sample data created successfully. |
```

## ğŸ”§ ìƒì„±ë˜ëŠ” êµ¬ì¡°

### ê¸°ë³¸ í…Œì´ë¸” (8ê°œ)
- `users` - ì‚¬ìš©ì ì •ë³´
- `user_health_info` - ì‚¬ìš©ì ê±´ê°• ì •ë³´ (BMI ìë™ ê³„ì‚°)
- `imu_data` - IMU ì„¼ì„œ ë°ì´í„°
- `embedding_data` - ì„ë² ë”© ë°ì´í„°
- `analysis_results` - ë³´í–‰ ë¶„ì„ ê²°ê³¼ (ê°œì„ ëœ ë²„ì „)
- `chat_history` - ì±„íŒ… íˆìŠ¤í† ë¦¬
- `gait_rag_data` - ë³´í–‰ RAG ë°ì´í„°
- `fall_data` - ë‚™ìƒ ê°ì§€ ë°ì´í„°

### ê³ ê¸‰ í…Œì´ë¸” (4ê°œ)
- `langchain_analysis_sessions` - ë­ì²´ì¸ ë¶„ì„ ì„¸ì…˜
- `model_performance_logs` - AI ëª¨ë¸ ì„±ëŠ¥ ì¶”ì 
- `user_feedback` - ì‚¬ìš©ì í”¼ë“œë°±
- `notifications` - ì‹¤ì‹œê°„ ì•Œë¦¼

### ìë™í™” ê¸°ëŠ¥
- BMI ìë™ ê³„ì‚° íŠ¸ë¦¬ê±°
- updated_at ìë™ ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°
- ì„±ëŠ¥ ìµœì í™” ì¸ë±ìŠ¤ë“¤
- ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ ë·°
- ë¶„ì„ ê²°ê³¼ ìƒì„¸ ë·°

### ìƒ˜í”Œ ë°ì´í„°
- 2ëª…ì˜ í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì
- 5ê°€ì§€ ë³´í–‰ íŒ¨í„´ ë°ì´í„°
- ìƒ˜í”Œ ë¶„ì„ ê²°ê³¼
- ì•Œë¦¼ ë° í”¼ë“œë°± ë°ì´í„°

## âœ… ê²€ì¦ ë°©ë²•

### 1. ì‹œê°„ëŒ€ í™•ì¸
```sql
SELECT 
    current_setting('timezone') AS timezone,
    EXTRACT(TIMEZONE FROM NOW()::TIMESTAMPTZ) / 3600 AS offset_hours;
-- ê²°ê³¼: timezone = 'Asia/Seoul', offset_hours = 9
```

### 2. í…Œì´ë¸” êµ¬ì¡° í™•ì¸
```sql
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' AND table_type = 'BASE TABLE'
ORDER BY table_name;
-- 11ê°œ í…Œì´ë¸”ì´ ëª¨ë‘ ë‚˜íƒ€ë‚˜ì•¼ í•¨
```

### 3. ìƒ˜í”Œ ë°ì´í„° í™•ì¸
```sql
SELECT * FROM user_dashboard_view;
-- 2ëª…ì˜ ì‚¬ìš©ì ì •ë³´ê°€ ë‚˜íƒ€ë‚˜ì•¼ í•¨
```

## ğŸ”„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘

### 1. ë°±ì—”ë“œ ì„œë²„ ì¬ì‹œì‘
```bash
cd gait-analysis-app/backend
python app/main.py
```

### 2. ì—°ê²° í…ŒìŠ¤íŠ¸
- API ì—”ë“œí¬ì¸íŠ¸ ì ‘ì† í™•ì¸
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
- ì‹œê°„ëŒ€ ì •ìƒ ì‘ë™ í™•ì¸

## ğŸ†˜ ë¬¸ì œ í•´ê²°

### ê¶Œí•œ ì˜¤ë¥˜
```
ERROR: permission denied
```
**í•´ê²°**: ë°ì´í„°ë² ì´ìŠ¤ ì†Œìœ ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰

### ì™¸ë˜í‚¤ ì˜¤ë¥˜
```
ERROR: cannot drop table because other objects depend on it
```
**í•´ê²°**: CASCADE ì˜µì…˜ì´ í¬í•¨ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ë¨

### ì‹œê°„ëŒ€ ì„¤ì • ì‹¤íŒ¨
```
timezone_status: Timezone needs adjustment âš ï¸
```
**í•´ê²°**: 
1. `ALTER DATABASE` ëª…ë ¹ì˜ ì£¼ì„ í•´ì œ
2. ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ìœ¼ë¡œ ë³€ê²½
3. ìŠ¤í¬ë¦½íŠ¸ ì¬ì‹¤í–‰

## ğŸ¯ ì™„ë£Œ í›„ í˜œíƒ

âœ… **ì‹œê°„ëŒ€ ë¬¸ì œ ì™„ì „ í•´ê²°** - Asia/Seoul ì˜êµ¬ ì„¤ì •  
âœ… **ìµœì‹  ìŠ¤í‚¤ë§ˆ ì ìš©** - ëª¨ë“  ê°œì„ ì‚¬í•­ í¬í•¨  
âœ… **ì„±ëŠ¥ ìµœì í™”** - ì¸ë±ìŠ¤ ë° ë·° ìë™ ìƒì„±  
âœ… **ìƒ˜í”Œ ë°ì´í„° ì œê³µ** - ì¦‰ì‹œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥  
âœ… **ìë™í™” ê¸°ëŠ¥** - BMI ê³„ì‚°, ì‹œê°„ ì—…ë°ì´íŠ¸ ë“±  
âœ… **ê¹”ë”í•œ ì‹œì‘** - ë¶ˆí•„ìš”í•œ ë°ì´í„° ì—†ìŒ  

ì´ì œ ì‹œê°„ëŒ€ ë¬¸ì œ ì—†ì´ ê¹”ë”í•˜ê²Œ ë³´í–‰ ë¶„ì„ ì•±ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸ‰ 